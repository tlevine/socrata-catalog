---
title: What file formats are on the data portals?
---
```{r configure, echo = F}
opts_chunk$set(fig.width=10, fig.height=5, dpi = 42 * 5)
```

While [at Socrata's office]() on Friday,
I learned of the [`/data.json`](https://data.oregon.gov/data.json) endpoint.
It contains an entry for each [dataset](),
uploaded by the data publisher; it doesn't contain all of the other
views that are based on these source datasets.
And it has [this format](http://project-open-data.github.io/schema/).

## How many datasets?
Socrata portals have [50,000 different views](), but only
`r nrow(datasets)` are original datasets, with a median of
`r median(table(datasets$portal))` datasets per portal.

```{r portal-counts, fig.width = 10, fig.height = 15}
p.portal.counts
```

This is much lower than my [earlier figure]()
that included [derived views]() (map, charts, &c.) and
[federated data]() (duplicates).

I'd like some time to compare the within-portal counts of original datasets
and derived datasets. But not right now.

## My curiousity about file formats
I've recently become curious about what formats the datasets come from. When
tabular data get loaded into a Socrata data portal, they get converted to a
tabular representation within the portal software. From that, they get converted
to a range of different tabular formats.

The Socrata data portal doesn't explicitly store the source format because of
how the import process works. Most of the data [probably come from Excel](scraperwiki),
and the data that aren't from Excel typically come from inside of a government
network where policies would make it inconvenient to expose the database to the
world. Because of this, Socrata doesn't query database servers. Instead, data
publishers write middlemen that act as both database clients and Socrata clients.
They query the database and then make [web requests](api)
to the Socrata portal.

## `/data.json` contains file format information
The `/data.json` endpoint contains a file format field per the Project Open Data
schema. This refers to the format of the data as served from the Socrata portal,
not the format it was stored in before it got to the Socrata portal. But this
still tells us something about the source file formats.

People sometimes upload things that Socrata doesn't interpret as tables. PDFs are
a major example. Other times, people upload or [link to]()
files that could be tables but don't specify that they are tables. Here are some
of the main types.


```{r csv-cum-facet, fig.width = 20, fig.height = 10}
p.csv.cum.facet
```


Some interesting portals

```{r mo}
p.data.mo.gov
```

```{r csv-pdf-cum-facet, fig.width = 20, fig.height = 10}
p.csv.pdf.cum.facet
```

```{r hawaii}
p.data.hawaii.gov
```

```{r lehman}
p.bronx.lehman.cuny.edu
```

```{r all-formats, fig.width = 10, fig.height = 15}
p.all
```

```{r sf}
p.data.sfgov.org
```
